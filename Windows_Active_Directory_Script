# Simple Active Directory Management Script
# Note: This script requires the Active Directory module for PowerShell.
# Ensure you have the necessary permissions to manage AD objects before running.

# Import the Active Directory module
Import-Module ActiveDirectory

# Step 1: Create a New User
# Replace 'OU=Users,DC=example,DC=com'
# This command creates a new user with a specified username, full name, and initial password.
$UserName = "jdoe"
$FullName = "John Doe"
$Password = ConvertTo-SecureString "P@ssw0rd!" -AsPlainText -Force
New-ADUser -Name $FullName -SamAccountName $UserName -UserPrincipalName "$UserName@example.com" `
           -Path "OU=Users,DC=example,DC=com" -AccountPassword $Password -Enabled $true
Write-Host "Created new user: $FullName"

# Step 2: Add the User to a Group
# This command adds the new user to a specified AD group.
$GroupName = "IT Department"
Add-ADGroupMember -Identity $GroupName -Members $UserName
Write-Host "Added $FullName to group: $GroupName"

# Step 3: Reset the User Password
# This command resets the user's password. Replace the password with a secure one for production use.
$NewPassword = ConvertTo-SecureString "N3wP@ssw0rd!" -AsPlainText -Force
Set-ADAccountPassword -Identity $UserName -NewPassword $NewPassword -Reset
Write-Host "Password reset for user: $FullName"
